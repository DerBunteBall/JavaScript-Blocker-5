@import "../shared-before.less";

.shared-before(@empty);

.jsb-element {
	& {
		background: darken(#fff, @darknessLevel);

		&,
		body {
			height: 100%;
			overflow: hidden;
			box-sizing: border-box;
		}
	}

	.popover-resize {
		position: fixed;

		&-bottom {
			width: 100%;
			height: 4px;
			bottom: 0;
			left: 0;
			cursor: ns-resize;
		}

		&-left,
		&-right {
			top: 0;
			width: 4px;
			height: 100%;
			cursor: ew-resize;
		}

		&-left {
			left: 0;
		}

		&-right {
			right: 0;
		}
	}

	#modal-overlay {
		display: none;
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: 600;
		-webkit-user-select: none;
		background: rgba(255, 255, 255, 0.03);
	}

	#container {
		height: 100%;

		#too-old {
			display: none;
			position: fixed;
			padding-top: 80px;
			top: 0;
			left: 0;
			background: #111;
			width: 100%;
			height: 100%;
			z-index: 214159;

			.jsb-info {
				color: #eee;
			
				&,
				& * {
					font-size: 15pt;
				}
			}
		}

		#change-log {
			&,
			* {
				line-height: 1.5;
			}
		}

		#view-container {
			height: 100%;
			display: -webkit-flex;
			-webkit-flex-direction: column;
			-webkit-transform: translateZ(0px);
			-webkit-filter: blur(0px) contrast(100%) brightness(100%);
			-webkit-transition: -webkit-filter unit(0.12 * @speedMultiplier, s) ease-out;

			.yosemite& {
				padding: 0 2px;
			}

			.transition() {
				-webkit-transition: background unit(0.15 * @speedMultiplier, s) ease-out, width unit(0.25 * @speedMultiplier, s) ease-out, padding unit(0.25 * @speedMultiplier, s) ease-out;
			}

			&.modal-blur {
				-webkit-filter: blur(12px) contrast(109%) brightness(105%);
			}

			#view-toolbar {
				position: relative;
				margin: 0;
				padding-top: 2px;
				z-index: 500;
				-webkit-flex: 0 0 24px;
				border-bottom: 1px solid rgba(0, 0, 0, 0.1);
				background: darken(rgb(245, 245, 245), @darknessLevel);
				overflow: hidden;

				& when (@darkMode) {
					border-bottom-color: rgba(0, 0, 0, 0.4);
				}

				.yosemite& {
					padding-top: 4px;
				}

				&,
				& * {
					-webkit-user-select: none;
				}

				#full-toggle,
				#open-menu {
					position: absolute;
					top: 2px;
					padding: 1px 5px 0;
					margin: 0 2px;
					color: #333;
					cursor: default;
					line-height: 19px;
					border-radius: 4px;

					.darkness-color();

					&[data-poppy] {
						.poppy-menu-target:after {
							color: #ccc;

							& when (@darkMode) {
								color: #555;
							}
						}
					}

					.yosemite& {
						top: 4px;
					}
					
					.transition;

					&:active {
						&,
						* {
							color: #000;

							& when (@darkMode) {
								color: #bbb;
							}
						}
					}

					&.is-disabled,
					&.unread-error {
						&,
						* {
							color: #fff;
						}

						box-shadow: 0 1px 0 darken(#cacaca, @darknessLevel);
					}

					&.is-disabled {
						background: desaturate(darken(@baseColor, 14%), 20%);
						background: -webkit-linear-gradient(top, rgb(108, 108, 108), rgb(103, 103, 103));

						&:active {
							background: darken(@baseColor, 22%);
							background: -webkit-linear-gradient(top, rgb(86, 86, 86), rgb(81, 81, 81));
						}

						&[data-poppy] .poppy-menu-target:after {
							color: #aaa;
						}
					}

					&.unread-error {
						background: darken(red, 10%);

						&:active {
							background: darken(red, 15%);
						}
					}
				}

				#open-menu {
					right: 0;
				}
			}

			.view-switcher-container {
				position: absolute;
				left: 50%;
				border-radius: 5px;

				&,
				& * {
					-webkit-user-select: none;
				}

				.view-switcher {
					position: relative;
					left: -50%;
					white-space: nowrap;
					height: 20px;
					list-style: none;
					border-radius: 4px;
					overflow: hidden;
					box-shadow: 0 1px 0 darken(#cacaca, @darknessLevel);

					.jsb-large-font& {
						font-size: 10pt;
					}

					li {
						border-top: 1px solid darken(#fff, @darknessLevel);
						border-left: 1px solid darken(rgb(225, 225, 225), @darknessLevel);
						display: inline-block;
						list-style-type: none;
						text-align: center;
						height: 19px;
						cursor: default;
						background: -webkit-linear-gradient(top, darken(#fff, @darknessLevel), darken(#fff, @darknessLevel));
						width: 74px;

						.jsb-large-font& {
							width: 72px;
						}

						.transition;

						&:first-child {
							&,
							&.active-view {
								border-left-color: transparent;
							}
						}

						&.active-view {
							&,
							+ li,
							+ li.view-switcher-hidden + li:not(.view-switcher-hidden),
							+ li.view-switcher-hidden + li.view-switcher-hidden + li:not(.view-switcher-hidden),
							+ li.view-switcher-hidden + li.view-switcher-hidden + li.view-switcher-hidden + li:not(.view-switcher-hidden) {
								border-left-color: darken(@baseColor, 24%);
								border-left-color: rgb(86, 86, 86);
							}

							background: -webkit-linear-gradient(top, desaturate(darken(@baseColor, 14%), 20%), desaturate(darken(@baseColor, 16%), 20%));
							background: -webkit-linear-gradient(top, rgb(108, 108, 108), rgb(103, 103, 103));

							border-top-color: desaturate(darken(@baseColor, 15%), 20%);
							border-top-color: rgb(108, 108, 108);

							& when (@darkMode) {
								background: -webkit-linear-gradient(top, rgb(88, 88, 88), rgb(83, 83, 83));
								border-top-color: rgb(88, 88, 88);
							}

							&,
							.view-switcher-item-container .view-switcher-item-name {
								color: #fff;
							}
						}

						&:active:not(.css-is-dumb) {
							background: -webkit-linear-gradient(top, darken(#f0f0f0, @darknessLevel), darken(#f0f0f0, @darknessLevel));
							border-top-color: darken(#fdfdfd, @darknessLevel);

							&.active-view {
								background: -webkit-linear-gradient(top, darken(@baseColor, 22%), darken(@baseColor, 24%));
								background: -webkit-linear-gradient(top, rgb(86, 86, 86), rgb(81, 81, 81));
								border-top-color: darken(@baseColor, 22%);
								border-top-color: rgb(86, 86, 86);

								& when (@darkMode) {
									background: -webkit-linear-gradient(top, rgb(81, 81, 81), rgb(76, 76, 76));
									border-top-color: rgb(81, 81, 81);
								}
							}
						}

						&.view-switcher-hidden:not(.active-view) {
							border-left: none;
							width: 0;
							overflow: hidden;
						}

						.view-switcher-item-container {
							display: inline-block;
							position: relative;
							line-height: 18px;
							text-align: center;
							white-space: nowrap;

							.view-switcher-item-name {
								color: #616161;								
								white-space: nowrap;

								.darkness-color();
							}

							.transition;

							.jsb-large-font& {
								line-height: 17px;
							}

							.view-switcher-item-notification {
								display: none;
								position: absolute;
								bottom: 5px;
								left: 100%;
								margin-left: 3px;
								height: 6px;
								min-width: 7px;
								padding: 3px 4px;
								border-radius: 10px;
								background: lighten(red, 8%);
								text-align: center;
								line-height: 5px;
								color: #fff;
								border: 1px solid rgba(0, 0, 0, 0.2);
								font-size: 85%;
								text-shadow: 0 1px 0 rgba(0, 0, 0, 0.05);
								box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2);
								z-index: 2;
								white-space: nowrap;

								.jsb-large-font& {
									bottom: 4px;
								}
							}
						}

						&[data-poppy] {
							.view-switcher-item-notification {
								margin-left: 5px;
							}

							.poppy-menu-target:after {
								// margin-right: -3px;
							}

							&.active-view .poppy-menu-target:after {
								color: #aaa;
							}
						}
					}
				}

				&.mini {
					.view-switcher {
						height: 18px;

						li {
							height: 17px;

							.view-switcher-item-container {
								line-height: 16px;
							}
						}
					}
				}
			}

			.ui-view {
				background: darken(#fff, @darknessLevel);

				&.active-view {
					display: block;
				}

				.floated-header {
					position: absolute;
					z-index: 5;
				}
			}

			.ui-view,
			.ui-view:not(.active-view) .ui-view {
				display: none;
			}

			.ui-view-container::-webkit-scrollbar {
				width: 9px;
				height: 9px;
			}

			*[data-poppy] {				
				.poppy-menu-target:after {
					display: inline-block;
					position: relative;
					top: -6px;
					content: ' âŒ„';
					margin-left: 3px;
					color: #d2d2d2;
					-webkit-transform: scale(1.3, 1);
					-webkit-font-smoothing: antialiased;
					font-weight: bold;
					font-size: 21px;
					line-height: 0;

					& when (@darkMode) {
						color: #555;
					}
				}

				&.poppy-menu-disabled .poppy-menu-target:after {
					display: none;
				}
			}

			#main-views {
				-webkit-flex: 1 1 auto;
				overflow-y: scroll;
				overflow-x: hidden;
				padding: 2px 0 0;
				margin-top: 1px;

				.yosemite& {
					margin-bottom: 2px;
				}

				.snapshot-info {
					display: none;
				}
			}
		}

		@import "view.setup.less";
		@import "view.page.less";
		@import "view.resource.less";
		@import "view.setting.less";
		@import "view.rule.less";
		@import "view.snapshot.less";
	}
}

@import "../shared-after.less";

.shared-after(@empty);
